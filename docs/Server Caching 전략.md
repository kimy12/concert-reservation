# 캐시(Cache)
데이터를 임시로 저장해 두는 장소를 의미. 

# 캐싱(Caching)
이 저장 공간을 활용하여 데이터를 빠르게 제공하기 위한 기법이나 과정

## 캐싱 전략

## 1. 캐시 읽기 전략 (Read Cache Strategy)
### 1.1. Cache-Aside (= Look Aside ,Lazy Loading) 전략

캐시(Cache)에서 데이터를 확인하고, 없다면 db를 통해 조회해온다.

- 캐시에 데이터가 있을 경우 (= Cache Hit)

> 애플리케이션에서 레디스에 데이터를 요청하고 레디스는 애플리케이션에 응답 테이터를 리턴한다.

- 캐시에 데이터가 없을 경우 (= Cache Miss)
> 1. 에플리케이션에서 레디스에 데이터를 요청한다. (캐시에 데이터 없음)
> 2. 애플리케이션에서 db에 데이터를 요청한다.
> 3. db는 애플리케이션에 응답데이터를 리턴한다.
> 4. 애플리케이션은 캐시에 데이터를 저장한다.

하지만 이 경우 문제가 발생하기도 하는데, 여러 어플이 동시에 특정 키가 만료되었을을 인지하는 경우, 동시에 db에 접근하여 데이터를 가져오려고 시도하여 데이터베이스의
과부하가 발생할 수 있고이를 '캐시 스탬피드 현상' 이라고 한다. 해결방안으로는 적절한 만료 시간 설정 (너무 짧게 설정 X), 키가 만료되기 전에 값을 미리 갱신 등이 있다.

### 1.2. Read-Through 전략

캐시(Cache)에서만 데이터를 읽어오는 전략 (inline cache)

> 1. 에플리케이션에서 레디스에 데이터를 요청한다. (캐시에 데이터 없음)
> 2. 캐시에 데이터가 없을 경우 db에 데이터를 조회하여 자체 업데이트한다.
> 3. 캐시에서 데이터를 가져온다.

## 2. 캐시 쓰기 전략 (Read Cache Strategy)

### 2.1. Write-Through 전략
db와 캐시에 동시에 데이터를 저장하는 전략
> 1. db에 저장할 데이터가 있으면 우선 캐시에 저장한다.
> 2. 곧바로 캐시에서 db로 저장한다.

### 2.2. Write-Behind (Write-Back) 전략
데이터를 저장할때 db에 바로 저장하지 않고, 캐시에 모아서 일정 주기 매치 작업을 통해 db에 반영
> 1. 모든데이터를 캐시에 저장한다.
> 2. 일정 시간이 지난 뒤 db에 한거번에 저장한다.

- - -

추후에 특정콘서트나 좌석정보를 자주 조회했을때 모든 요청이 데이터베이스에 직접 접근하면 성능저하나 과도한 부하가 발생할 수 있기때문에 콘서트 조회 로직을 위와 같은
위의 캐싱 전략 중 Redis를 캐시로 사용하고 필요한 경우에만 db를 참조하는 Cache-Aside 전략을 사용할 수 있을 것같다.


- - -

## Redis 기반 대기열 시스템 구현 방향

현재, 콘서트 예약 시스템에서 대기열 기능은 db로 구현되어있으며,

몇가지 단점이 존재한다.
>
> 1. 성능 문제 : 동시 요청이 대량으로 발행하면, 처리 속도가 느려질 수 있다. 특히 콘서트 예약과 같은 서비스에서는 수만건의 동시 트랜젝션의 발생이 있을 수 있는데,
> 데이터 베이스로는 이러한 트래픽을 효율적으로 처리하기 어렵다.
> 2. 속도 문제 : 대기열을 조회하고 저장 등을 하기에 데이터베이스의 응답시간이 상대적으로 길다. 또한 
> Redis 같은 메모리 기반 데이터 저장소에 비해서 속도가 느리다.
> 3. 비용 문제 : 데이터베이스로 대규모 트래픽을 제어한다면, 큰 바용이 발생할 수 있다.

이와 같은 문제점들을 방지하고자, 대기열의 로직을 db가 아닌, redis를 이용해 대기열 토큰 관리 로직을 리팩터링 하려고 한다. 


